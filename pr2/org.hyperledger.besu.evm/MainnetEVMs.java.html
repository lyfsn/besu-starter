<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MainnetEVMs.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">besu</a> &gt; <a href="index.source.html" class="el_package">org.hyperledger.besu.evm</a> &gt; <span class="el_source">MainnetEVMs.java</span></div><h1>MainnetEVMs.java</h1><pre class="source lang-java linenums">/*
 * Copyright ConsenSys AG.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with
 * the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on
 * an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */
package org.hyperledger.besu.evm;

import org.hyperledger.besu.evm.gascalculator.BerlinGasCalculator;
import org.hyperledger.besu.evm.gascalculator.ByzantiumGasCalculator;
import org.hyperledger.besu.evm.gascalculator.CancunGasCalculator;
import org.hyperledger.besu.evm.gascalculator.ConstantinopleGasCalculator;
import org.hyperledger.besu.evm.gascalculator.FrontierGasCalculator;
import org.hyperledger.besu.evm.gascalculator.GasCalculator;
import org.hyperledger.besu.evm.gascalculator.HomesteadGasCalculator;
import org.hyperledger.besu.evm.gascalculator.IstanbulGasCalculator;
import org.hyperledger.besu.evm.gascalculator.LondonGasCalculator;
import org.hyperledger.besu.evm.gascalculator.PetersburgGasCalculator;
import org.hyperledger.besu.evm.gascalculator.PragueGasCalculator;
import org.hyperledger.besu.evm.gascalculator.ShanghaiGasCalculator;
import org.hyperledger.besu.evm.gascalculator.SpuriousDragonGasCalculator;
import org.hyperledger.besu.evm.gascalculator.TangerineWhistleGasCalculator;
import org.hyperledger.besu.evm.internal.EvmConfiguration;
import org.hyperledger.besu.evm.operation.AddModOperation;
import org.hyperledger.besu.evm.operation.AddOperation;
import org.hyperledger.besu.evm.operation.AddressOperation;
import org.hyperledger.besu.evm.operation.AndOperation;
import org.hyperledger.besu.evm.operation.BalanceOperation;
import org.hyperledger.besu.evm.operation.BaseFeeOperation;
import org.hyperledger.besu.evm.operation.BlobBaseFeeOperation;
import org.hyperledger.besu.evm.operation.BlobHashOperation;
import org.hyperledger.besu.evm.operation.BlockHashOperation;
import org.hyperledger.besu.evm.operation.ByteOperation;
import org.hyperledger.besu.evm.operation.CallCodeOperation;
import org.hyperledger.besu.evm.operation.CallDataCopyOperation;
import org.hyperledger.besu.evm.operation.CallDataLoadOperation;
import org.hyperledger.besu.evm.operation.CallDataSizeOperation;
import org.hyperledger.besu.evm.operation.CallFOperation;
import org.hyperledger.besu.evm.operation.CallOperation;
import org.hyperledger.besu.evm.operation.CallValueOperation;
import org.hyperledger.besu.evm.operation.CallerOperation;
import org.hyperledger.besu.evm.operation.ChainIdOperation;
import org.hyperledger.besu.evm.operation.CodeCopyOperation;
import org.hyperledger.besu.evm.operation.CodeSizeOperation;
import org.hyperledger.besu.evm.operation.CoinbaseOperation;
import org.hyperledger.besu.evm.operation.Create2Operation;
import org.hyperledger.besu.evm.operation.CreateOperation;
import org.hyperledger.besu.evm.operation.DelegateCallOperation;
import org.hyperledger.besu.evm.operation.DifficultyOperation;
import org.hyperledger.besu.evm.operation.DivOperation;
import org.hyperledger.besu.evm.operation.DupOperation;
import org.hyperledger.besu.evm.operation.EqOperation;
import org.hyperledger.besu.evm.operation.ExpOperation;
import org.hyperledger.besu.evm.operation.ExtCodeCopyOperation;
import org.hyperledger.besu.evm.operation.ExtCodeHashOperation;
import org.hyperledger.besu.evm.operation.ExtCodeSizeOperation;
import org.hyperledger.besu.evm.operation.GasLimitOperation;
import org.hyperledger.besu.evm.operation.GasOperation;
import org.hyperledger.besu.evm.operation.GasPriceOperation;
import org.hyperledger.besu.evm.operation.GtOperation;
import org.hyperledger.besu.evm.operation.InvalidOperation;
import org.hyperledger.besu.evm.operation.IsZeroOperation;
import org.hyperledger.besu.evm.operation.JumpDestOperation;
import org.hyperledger.besu.evm.operation.JumpOperation;
import org.hyperledger.besu.evm.operation.JumpiOperation;
import org.hyperledger.besu.evm.operation.Keccak256Operation;
import org.hyperledger.besu.evm.operation.LogOperation;
import org.hyperledger.besu.evm.operation.LtOperation;
import org.hyperledger.besu.evm.operation.MCopyOperation;
import org.hyperledger.besu.evm.operation.MLoadOperation;
import org.hyperledger.besu.evm.operation.MSizeOperation;
import org.hyperledger.besu.evm.operation.MStore8Operation;
import org.hyperledger.besu.evm.operation.MStoreOperation;
import org.hyperledger.besu.evm.operation.ModOperation;
import org.hyperledger.besu.evm.operation.MulModOperation;
import org.hyperledger.besu.evm.operation.MulOperation;
import org.hyperledger.besu.evm.operation.NotOperation;
import org.hyperledger.besu.evm.operation.NumberOperation;
import org.hyperledger.besu.evm.operation.OperationRegistry;
import org.hyperledger.besu.evm.operation.OrOperation;
import org.hyperledger.besu.evm.operation.OriginOperation;
import org.hyperledger.besu.evm.operation.PCOperation;
import org.hyperledger.besu.evm.operation.PopOperation;
import org.hyperledger.besu.evm.operation.PrevRanDaoOperation;
import org.hyperledger.besu.evm.operation.Push0Operation;
import org.hyperledger.besu.evm.operation.PushOperation;
import org.hyperledger.besu.evm.operation.RelativeJumpIfOperation;
import org.hyperledger.besu.evm.operation.RelativeJumpOperation;
import org.hyperledger.besu.evm.operation.RelativeJumpVectorOperation;
import org.hyperledger.besu.evm.operation.RetFOperation;
import org.hyperledger.besu.evm.operation.ReturnDataCopyOperation;
import org.hyperledger.besu.evm.operation.ReturnDataSizeOperation;
import org.hyperledger.besu.evm.operation.ReturnOperation;
import org.hyperledger.besu.evm.operation.RevertOperation;
import org.hyperledger.besu.evm.operation.SDivOperation;
import org.hyperledger.besu.evm.operation.SGtOperation;
import org.hyperledger.besu.evm.operation.SLoadOperation;
import org.hyperledger.besu.evm.operation.SLtOperation;
import org.hyperledger.besu.evm.operation.SModOperation;
import org.hyperledger.besu.evm.operation.SStoreOperation;
import org.hyperledger.besu.evm.operation.SarOperation;
import org.hyperledger.besu.evm.operation.SelfBalanceOperation;
import org.hyperledger.besu.evm.operation.SelfDestructOperation;
import org.hyperledger.besu.evm.operation.ShlOperation;
import org.hyperledger.besu.evm.operation.ShrOperation;
import org.hyperledger.besu.evm.operation.SignExtendOperation;
import org.hyperledger.besu.evm.operation.StaticCallOperation;
import org.hyperledger.besu.evm.operation.StopOperation;
import org.hyperledger.besu.evm.operation.SubOperation;
import org.hyperledger.besu.evm.operation.SwapOperation;
import org.hyperledger.besu.evm.operation.TLoadOperation;
import org.hyperledger.besu.evm.operation.TStoreOperation;
import org.hyperledger.besu.evm.operation.TimestampOperation;
import org.hyperledger.besu.evm.operation.XorOperation;

import java.math.BigInteger;

import org.apache.tuweni.bytes.Bytes;
import org.apache.tuweni.bytes.Bytes32;

/** Provides EVMs supporting the appropriate operations for mainnet hard forks. */
public class MainnetEVMs {

  /** The constant DEV_NET_CHAIN_ID. */
<span class="fc" id="L133">  public static final BigInteger DEV_NET_CHAIN_ID = BigInteger.valueOf(1337);</span>

  /** The constant SPURIOUS_DRAGON_CONTRACT_SIZE_LIMIT. */
  public static final int SPURIOUS_DRAGON_CONTRACT_SIZE_LIMIT = 0x6000;

  /** The constant SHANGHAI_INIT_CODE_SIZE_LIMIT. */
  public static final int SHANGHAI_INIT_CODE_SIZE_LIMIT = 2 * SPURIOUS_DRAGON_CONTRACT_SIZE_LIMIT;

  private MainnetEVMs() {
    // utility class
  }

  /**
   * Frontier evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM frontier(final EvmConfiguration evmConfiguration) {
<span class="fc" id="L152">    return frontier(new FrontierGasCalculator(), evmConfiguration);</span>
  }

  /**
   * Frontier evm.
   *
   * @param gasCalculator the gas calculator
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM frontier(
      final GasCalculator gasCalculator, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L164">    return new EVM(</span>
<span class="fc" id="L165">        frontierOperations(gasCalculator),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.FRONTIER);
  }

  /**
   * Operation registry for frontier's operations.
   *
   * @param gasCalculator the gas calculator
   * @return the operation registry
   */
  public static OperationRegistry frontierOperations(final GasCalculator gasCalculator) {
<span class="fc" id="L178">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L179">    registerFrontierOperations(operationRegistry, gasCalculator);</span>
<span class="fc" id="L180">    return operationRegistry;</span>
  }

  /**
   * Register frontier operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   */
  public static void registerFrontierOperations(
      final OperationRegistry registry, final GasCalculator gasCalculator) {
<span class="fc bfc" id="L191" title="All 2 branches covered.">    for (int i = 0; i &lt; 255; i++) {</span>
<span class="fc" id="L192">      registry.put(new InvalidOperation(i, gasCalculator));</span>
    }
<span class="fc" id="L194">    registry.put(new AddOperation(gasCalculator));</span>
<span class="fc" id="L195">    registry.put(new MulOperation(gasCalculator));</span>
<span class="fc" id="L196">    registry.put(new SubOperation(gasCalculator));</span>
<span class="fc" id="L197">    registry.put(new DivOperation(gasCalculator));</span>
<span class="fc" id="L198">    registry.put(new SDivOperation(gasCalculator));</span>
<span class="fc" id="L199">    registry.put(new ModOperation(gasCalculator));</span>
<span class="fc" id="L200">    registry.put(new SModOperation(gasCalculator));</span>
<span class="fc" id="L201">    registry.put(new ExpOperation(gasCalculator));</span>
<span class="fc" id="L202">    registry.put(new AddModOperation(gasCalculator));</span>
<span class="fc" id="L203">    registry.put(new MulModOperation(gasCalculator));</span>
<span class="fc" id="L204">    registry.put(new SignExtendOperation(gasCalculator));</span>
<span class="fc" id="L205">    registry.put(new LtOperation(gasCalculator));</span>
<span class="fc" id="L206">    registry.put(new GtOperation(gasCalculator));</span>
<span class="fc" id="L207">    registry.put(new SLtOperation(gasCalculator));</span>
<span class="fc" id="L208">    registry.put(new SGtOperation(gasCalculator));</span>
<span class="fc" id="L209">    registry.put(new EqOperation(gasCalculator));</span>
<span class="fc" id="L210">    registry.put(new IsZeroOperation(gasCalculator));</span>
<span class="fc" id="L211">    registry.put(new AndOperation(gasCalculator));</span>
<span class="fc" id="L212">    registry.put(new OrOperation(gasCalculator));</span>
<span class="fc" id="L213">    registry.put(new XorOperation(gasCalculator));</span>
<span class="fc" id="L214">    registry.put(new NotOperation(gasCalculator));</span>
<span class="fc" id="L215">    registry.put(new ByteOperation(gasCalculator));</span>
<span class="fc" id="L216">    registry.put(new Keccak256Operation(gasCalculator));</span>
<span class="fc" id="L217">    registry.put(new AddressOperation(gasCalculator));</span>
<span class="fc" id="L218">    registry.put(new BalanceOperation(gasCalculator));</span>
<span class="fc" id="L219">    registry.put(new OriginOperation(gasCalculator));</span>
<span class="fc" id="L220">    registry.put(new CallerOperation(gasCalculator));</span>
<span class="fc" id="L221">    registry.put(new CallValueOperation(gasCalculator));</span>
<span class="fc" id="L222">    registry.put(new CallDataLoadOperation(gasCalculator));</span>
<span class="fc" id="L223">    registry.put(new CallDataSizeOperation(gasCalculator));</span>
<span class="fc" id="L224">    registry.put(new CallDataCopyOperation(gasCalculator));</span>
<span class="fc" id="L225">    registry.put(new CodeSizeOperation(gasCalculator));</span>
<span class="fc" id="L226">    registry.put(new CodeCopyOperation(gasCalculator));</span>
<span class="fc" id="L227">    registry.put(new GasPriceOperation(gasCalculator));</span>
<span class="fc" id="L228">    registry.put(new ExtCodeCopyOperation(gasCalculator));</span>
<span class="fc" id="L229">    registry.put(new ExtCodeSizeOperation(gasCalculator));</span>
<span class="fc" id="L230">    registry.put(new BlockHashOperation(gasCalculator));</span>
<span class="fc" id="L231">    registry.put(new CoinbaseOperation(gasCalculator));</span>
<span class="fc" id="L232">    registry.put(new TimestampOperation(gasCalculator));</span>
<span class="fc" id="L233">    registry.put(new NumberOperation(gasCalculator));</span>
<span class="fc" id="L234">    registry.put(new DifficultyOperation(gasCalculator));</span>
<span class="fc" id="L235">    registry.put(new GasLimitOperation(gasCalculator));</span>
<span class="fc" id="L236">    registry.put(new PopOperation(gasCalculator));</span>
<span class="fc" id="L237">    registry.put(new MLoadOperation(gasCalculator));</span>
<span class="fc" id="L238">    registry.put(new MStoreOperation(gasCalculator));</span>
<span class="fc" id="L239">    registry.put(new MStore8Operation(gasCalculator));</span>
<span class="fc" id="L240">    registry.put(new SLoadOperation(gasCalculator));</span>
<span class="fc" id="L241">    registry.put(new SStoreOperation(gasCalculator, SStoreOperation.FRONTIER_MINIMUM));</span>
<span class="fc" id="L242">    registry.put(new JumpOperation(gasCalculator));</span>
<span class="fc" id="L243">    registry.put(new JumpiOperation(gasCalculator));</span>
<span class="fc" id="L244">    registry.put(new PCOperation(gasCalculator));</span>
<span class="fc" id="L245">    registry.put(new MSizeOperation(gasCalculator));</span>
<span class="fc" id="L246">    registry.put(new GasOperation(gasCalculator));</span>
<span class="fc" id="L247">    registry.put(new JumpDestOperation(gasCalculator));</span>
<span class="fc" id="L248">    registry.put(new ReturnOperation(gasCalculator));</span>
<span class="fc" id="L249">    registry.put(new InvalidOperation(gasCalculator));</span>
<span class="fc" id="L250">    registry.put(new StopOperation(gasCalculator));</span>
<span class="fc" id="L251">    registry.put(new SelfDestructOperation(gasCalculator));</span>
<span class="fc" id="L252">    registry.put(new CreateOperation(gasCalculator, Integer.MAX_VALUE));</span>
<span class="fc" id="L253">    registry.put(new CallOperation(gasCalculator));</span>
<span class="fc" id="L254">    registry.put(new CallCodeOperation(gasCalculator));</span>

    // Register the PUSH1, PUSH2, ..., PUSH32 operations.
<span class="fc bfc" id="L257" title="All 2 branches covered.">    for (int i = 1; i &lt;= 32; ++i) {</span>
<span class="fc" id="L258">      registry.put(new PushOperation(i, gasCalculator));</span>
    }

    // Register the DUP1, DUP2, ..., DUP16 operations.
<span class="fc bfc" id="L262" title="All 2 branches covered.">    for (int i = 1; i &lt;= 16; ++i) {</span>
<span class="fc" id="L263">      registry.put(new DupOperation(i, gasCalculator));</span>
    }

    // Register the SWAP1, SWAP2, ..., SWAP16 operations.
<span class="fc bfc" id="L267" title="All 2 branches covered.">    for (int i = 1; i &lt;= 16; ++i) {</span>
<span class="fc" id="L268">      registry.put(new SwapOperation(i, gasCalculator));</span>
    }

    // Register the LOG0, LOG1, ..., LOG4 operations.
<span class="fc bfc" id="L272" title="All 2 branches covered.">    for (int i = 0; i &lt; 5; ++i) {</span>
<span class="fc" id="L273">      registry.put(new LogOperation(i, gasCalculator));</span>
    }
<span class="fc" id="L275">  }</span>

  /**
   * Homestead evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM homestead(final EvmConfiguration evmConfiguration) {
<span class="fc" id="L284">    return homestead(new HomesteadGasCalculator(), evmConfiguration);</span>
  }

  /**
   * Homestead evm.
   *
   * @param gasCalculator the gas calculator
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM homestead(
      final GasCalculator gasCalculator, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L296">    return new EVM(</span>
<span class="fc" id="L297">        homesteadOperations(gasCalculator),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.HOMESTEAD);
  }

  /**
   * Operation registry for homestead's operations.
   *
   * @param gasCalculator the gas calculator
   * @return the operation registry
   */
  public static OperationRegistry homesteadOperations(final GasCalculator gasCalculator) {
<span class="fc" id="L310">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L311">    registerHomesteadOperations(operationRegistry, gasCalculator);</span>
<span class="fc" id="L312">    return operationRegistry;</span>
  }

  /**
   * Register homestead operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   */
  public static void registerHomesteadOperations(
      final OperationRegistry registry, final GasCalculator gasCalculator) {
<span class="fc" id="L323">    registerFrontierOperations(registry, gasCalculator);</span>
<span class="fc" id="L324">    registry.put(new DelegateCallOperation(gasCalculator));</span>
<span class="fc" id="L325">  }</span>

  /**
   * Spurious dragon evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM spuriousDragon(final EvmConfiguration evmConfiguration) {
<span class="fc" id="L334">    GasCalculator gasCalculator = new SpuriousDragonGasCalculator();</span>
<span class="fc" id="L335">    return new EVM(</span>
<span class="fc" id="L336">        homesteadOperations(gasCalculator),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.SPURIOUS_DRAGON);
  }

  /**
   * Tangerine whistle evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM tangerineWhistle(final EvmConfiguration evmConfiguration) {
<span class="fc" id="L349">    GasCalculator gasCalculator = new TangerineWhistleGasCalculator();</span>
<span class="fc" id="L350">    return new EVM(</span>
<span class="fc" id="L351">        homesteadOperations(gasCalculator),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.TANGERINE_WHISTLE);
  }

  /**
   * Byzantium evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM byzantium(final EvmConfiguration evmConfiguration) {
<span class="fc" id="L364">    return byzantium(new ByzantiumGasCalculator(), evmConfiguration);</span>
  }

  /**
   * Byzantium evm.
   *
   * @param gasCalculator the gas calculator
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM byzantium(
      final GasCalculator gasCalculator, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L376">    return new EVM(</span>
<span class="fc" id="L377">        byzantiumOperations(gasCalculator),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.BYZANTIUM);
  }

  /**
   * Operation registry for byzantium's operations.
   *
   * @param gasCalculator the gas calculator
   * @return the operation registry
   */
  public static OperationRegistry byzantiumOperations(final GasCalculator gasCalculator) {
<span class="fc" id="L390">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L391">    registerByzantiumOperations(operationRegistry, gasCalculator);</span>
<span class="fc" id="L392">    return operationRegistry;</span>
  }

  /**
   * Register byzantium operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   */
  public static void registerByzantiumOperations(
      final OperationRegistry registry, final GasCalculator gasCalculator) {
<span class="fc" id="L403">    registerHomesteadOperations(registry, gasCalculator);</span>
<span class="fc" id="L404">    registry.put(new ReturnDataCopyOperation(gasCalculator));</span>
<span class="fc" id="L405">    registry.put(new ReturnDataSizeOperation(gasCalculator));</span>
<span class="fc" id="L406">    registry.put(new RevertOperation(gasCalculator));</span>
<span class="fc" id="L407">    registry.put(new StaticCallOperation(gasCalculator));</span>
<span class="fc" id="L408">  }</span>

  /**
   * Constantinople evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM constantinople(final EvmConfiguration evmConfiguration) {
<span class="fc" id="L417">    return constantinople(new ConstantinopleGasCalculator(), evmConfiguration);</span>
  }

  /**
   * Constantinople evm.
   *
   * @param gasCalculator the gas calculator
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM constantinople(
      final GasCalculator gasCalculator, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L429">    var version = EvmSpecVersion.CONSTANTINOPLE;</span>
<span class="fc" id="L430">    return constantiNOPEl(gasCalculator, evmConfiguration, version);</span>
  }

  private static EVM constantiNOPEl(
      final GasCalculator gasCalculator,
      final EvmConfiguration evmConfiguration,
      final EvmSpecVersion version) {
<span class="fc" id="L437">    return new EVM(</span>
<span class="fc" id="L438">        constantinopleOperations(gasCalculator), gasCalculator, evmConfiguration, version);</span>
  }

  /**
   * Operation registry for constantinople's operations.
   *
   * @param gasCalculator the gas calculator
   * @return the operation registry
   */
  public static OperationRegistry constantinopleOperations(final GasCalculator gasCalculator) {
<span class="fc" id="L448">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L449">    registerConstantinopleOperations(operationRegistry, gasCalculator);</span>
<span class="fc" id="L450">    return operationRegistry;</span>
  }

  /**
   * Register constantinople operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   */
  public static void registerConstantinopleOperations(
      final OperationRegistry registry, final GasCalculator gasCalculator) {
<span class="fc" id="L461">    registerByzantiumOperations(registry, gasCalculator);</span>
<span class="fc" id="L462">    registry.put(new Create2Operation(gasCalculator, Integer.MAX_VALUE));</span>
<span class="fc" id="L463">    registry.put(new SarOperation(gasCalculator));</span>
<span class="fc" id="L464">    registry.put(new ShlOperation(gasCalculator));</span>
<span class="fc" id="L465">    registry.put(new ShrOperation(gasCalculator));</span>
<span class="fc" id="L466">    registry.put(new ExtCodeHashOperation(gasCalculator));</span>
<span class="fc" id="L467">  }</span>

  /**
   * Petersburg evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM petersburg(final EvmConfiguration evmConfiguration) {
<span class="fc" id="L476">    return constantiNOPEl(</span>
        new PetersburgGasCalculator(), evmConfiguration, EvmSpecVersion.PETERSBURG);
  }

  /**
   * Istanbul evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM istanbul(final EvmConfiguration evmConfiguration) {
<span class="nc" id="L487">    return istanbul(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * Istanbul evm.
   *
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM istanbul(final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L498">    return istanbul(new IstanbulGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * Istanbul evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM istanbul(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L513">    return new EVM(</span>
<span class="fc" id="L514">        istanbulOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.ISTANBUL);
  }

  /**
   * Operation registry for istanbul's operations.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @return the operation registry
   */
  public static OperationRegistry istanbulOperations(
      final GasCalculator gasCalculator, final BigInteger chainId) {
<span class="fc" id="L529">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L530">    registerIstanbulOperations(operationRegistry, gasCalculator, chainId);</span>
<span class="fc" id="L531">    return operationRegistry;</span>
  }

  /**
   * Register istanbul operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   */
  public static void registerIstanbulOperations(
      final OperationRegistry registry,
      final GasCalculator gasCalculator,
      final BigInteger chainId) {
<span class="fc" id="L545">    registerConstantinopleOperations(registry, gasCalculator);</span>
<span class="fc" id="L546">    registry.put(</span>
<span class="fc" id="L547">        new ChainIdOperation(gasCalculator, Bytes32.leftPad(Bytes.of(chainId.toByteArray()))));</span>
<span class="fc" id="L548">    registry.put(new SelfBalanceOperation(gasCalculator));</span>
<span class="fc" id="L549">    registry.put(new SStoreOperation(gasCalculator, SStoreOperation.EIP_1706_MINIMUM));</span>
<span class="fc" id="L550">  }</span>

  /**
   * Berlin evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM berlin(final EvmConfiguration evmConfiguration) {
<span class="nc" id="L559">    return berlin(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * Berlin evm.
   *
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM berlin(final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L570">    return berlin(new BerlinGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * Berlin evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM berlin(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L585">    return new EVM(</span>
<span class="fc" id="L586">        istanbulOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.BERLIN);
  }

  /**
   * London evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM london(final EvmConfiguration evmConfiguration) {
<span class="fc" id="L599">    return london(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * London evm.
   *
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM london(final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L610">    return london(new LondonGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * London evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM london(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L625">    return new EVM(</span>
<span class="fc" id="L626">        londonOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.LONDON);
  }

  /**
   * Operation registry for london's operations.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @return the operation registry
   */
  public static OperationRegistry londonOperations(
      final GasCalculator gasCalculator, final BigInteger chainId) {
<span class="fc" id="L641">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L642">    registerLondonOperations(operationRegistry, gasCalculator, chainId);</span>
<span class="fc" id="L643">    return operationRegistry;</span>
  }

  /**
   * Register london operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   */
  public static void registerLondonOperations(
      final OperationRegistry registry,
      final GasCalculator gasCalculator,
      final BigInteger chainId) {
<span class="fc" id="L657">    registerIstanbulOperations(registry, gasCalculator, chainId);</span>
<span class="fc" id="L658">    registry.put(new BaseFeeOperation(gasCalculator));</span>
<span class="fc" id="L659">  }</span>

  /**
   * Paris evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM paris(final EvmConfiguration evmConfiguration) {
<span class="nc" id="L668">    return paris(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * Paris evm.
   *
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM paris(final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L679">    return paris(new LondonGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * Paris evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM paris(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L694">    return new EVM(</span>
<span class="fc" id="L695">        parisOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.PARIS);
  }

  /**
   * Operation registry for paris's operations.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @return the operation registry
   */
  public static OperationRegistry parisOperations(
      final GasCalculator gasCalculator, final BigInteger chainId) {
<span class="fc" id="L710">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L711">    registerParisOperations(operationRegistry, gasCalculator, chainId);</span>
<span class="fc" id="L712">    return operationRegistry;</span>
  }

  /**
   * Register paris operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   * @param chainID the chain id
   */
  public static void registerParisOperations(
      final OperationRegistry registry,
      final GasCalculator gasCalculator,
      final BigInteger chainID) {
<span class="fc" id="L726">    registerLondonOperations(registry, gasCalculator, chainID);</span>
<span class="fc" id="L727">    registry.put(new PrevRanDaoOperation(gasCalculator));</span>
<span class="fc" id="L728">  }</span>

  /**
   * Shanghai evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM shanghai(final EvmConfiguration evmConfiguration) {
<span class="nc" id="L737">    return shanghai(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * Shanghai evm
   *
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM shanghai(final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L748">    return shanghai(new ShanghaiGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * shanghai evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM shanghai(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L763">    return new EVM(</span>
<span class="fc" id="L764">        shanghaiOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.SHANGHAI);
  }

  /**
   * shanghai operations registry.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @return the operation registry
   */
  public static OperationRegistry shanghaiOperations(
      final GasCalculator gasCalculator, final BigInteger chainId) {
<span class="fc" id="L779">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L780">    registerShanghaiOperations(operationRegistry, gasCalculator, chainId);</span>
<span class="fc" id="L781">    return operationRegistry;</span>
  }

  /**
   * Register Shanghai operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   * @param chainID the chain id
   */
  public static void registerShanghaiOperations(
      final OperationRegistry registry,
      final GasCalculator gasCalculator,
      final BigInteger chainID) {
<span class="fc" id="L795">    registerParisOperations(registry, gasCalculator, chainID);</span>
<span class="fc" id="L796">    registry.put(new Push0Operation(gasCalculator));</span>
<span class="fc" id="L797">    registry.put(new CreateOperation(gasCalculator, SHANGHAI_INIT_CODE_SIZE_LIMIT));</span>
<span class="fc" id="L798">    registry.put(new Create2Operation(gasCalculator, SHANGHAI_INIT_CODE_SIZE_LIMIT));</span>
<span class="fc" id="L799">  }</span>

  /**
   * Cancun evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM cancun(final EvmConfiguration evmConfiguration) {
<span class="fc" id="L808">    return cancun(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * Cancun evm.
   *
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM cancun(final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L819">    return cancun(new CancunGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * Cancun evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM cancun(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L834">    return new EVM(</span>
<span class="fc" id="L835">        cancunOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.CANCUN);
  }

  /**
   * Operation registry for cancun's operations.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @return the operation registry
   */
  public static OperationRegistry cancunOperations(
      final GasCalculator gasCalculator, final BigInteger chainId) {
<span class="fc" id="L850">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L851">    registerCancunOperations(operationRegistry, gasCalculator, chainId);</span>
<span class="fc" id="L852">    return operationRegistry;</span>
  }

  /**
   * Register cancun operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   * @param chainID the chain id
   */
  public static void registerCancunOperations(
      final OperationRegistry registry,
      final GasCalculator gasCalculator,
      final BigInteger chainID) {
<span class="fc" id="L866">    registerShanghaiOperations(registry, gasCalculator, chainID);</span>

    // EIP-1153 TSTORE/TLOAD
<span class="fc" id="L869">    registry.put(new TStoreOperation(gasCalculator));</span>
<span class="fc" id="L870">    registry.put(new TLoadOperation(gasCalculator));</span>

    // EIP-4844 BLOBHASH
<span class="fc" id="L873">    registry.put(new BlobHashOperation(gasCalculator));</span>

    // EIP-5656 MCOPY
<span class="fc" id="L876">    registry.put(new MCopyOperation(gasCalculator));</span>

    // EIP-6780 nerf self destruct
<span class="fc" id="L879">    registry.put(new SelfDestructOperation(gasCalculator, true));</span>

    // EIP-7516 BLOBBASEFEE
<span class="fc" id="L882">    registry.put(new BlobBaseFeeOperation(gasCalculator));</span>
<span class="fc" id="L883">  }</span>

  /**
   * Prague evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM prague(final EvmConfiguration evmConfiguration) {
<span class="nc" id="L892">    return prague(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * Prague evm.
   *
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM prague(final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L903">    return prague(new PragueGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * Prague evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM prague(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L918">    return new EVM(</span>
<span class="fc" id="L919">        pragueOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.PRAGUE);
  }

  /**
   * Operation registry for prague's operations.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @return the operation registry
   */
  public static OperationRegistry pragueOperations(
      final GasCalculator gasCalculator, final BigInteger chainId) {
<span class="fc" id="L934">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L935">    registerPragueOperations(operationRegistry, gasCalculator, chainId);</span>
<span class="fc" id="L936">    return operationRegistry;</span>
  }

  /**
   * Register prague operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   * @param chainID the chain id
   */
  public static void registerPragueOperations(
      final OperationRegistry registry,
      final GasCalculator gasCalculator,
      final BigInteger chainID) {
<span class="fc" id="L950">    registerCancunOperations(registry, gasCalculator, chainID);</span>
<span class="fc" id="L951">  }</span>

  /**
   * Osaka evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM osaka(final EvmConfiguration evmConfiguration) {
<span class="nc" id="L960">    return osaka(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * Osaka evm.
   *
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM osaka(final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L971">    return osaka(new PragueGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * Osaka evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM osaka(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L986">    return new EVM(</span>
<span class="fc" id="L987">        osakaOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.OSAKA);
  }

  /**
   * Operation registry for osaka's operations.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @return the operation registry
   */
  public static OperationRegistry osakaOperations(
      final GasCalculator gasCalculator, final BigInteger chainId) {
<span class="fc" id="L1002">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L1003">    registerOsakaOperations(operationRegistry, gasCalculator, chainId);</span>
<span class="fc" id="L1004">    return operationRegistry;</span>
  }

  /**
   * Register osaka operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   * @param chainID the chain id
   */
  public static void registerOsakaOperations(
      final OperationRegistry registry,
      final GasCalculator gasCalculator,
      final BigInteger chainID) {
<span class="fc" id="L1018">    registerPragueOperations(registry, gasCalculator, chainID);</span>
<span class="fc" id="L1019">  }</span>

  /**
   * Bogota evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM bogota(final EvmConfiguration evmConfiguration) {
<span class="nc" id="L1028">    return bogota(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * Bogota evm.
   *
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM bogota(final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L1039">    return bogota(new PragueGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * Bogota evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM bogota(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L1054">    return new EVM(</span>
<span class="fc" id="L1055">        bogotaOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.BOGOTA);
  }

  /**
   * Bogota operation registry.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @return the operation registry
   */
  public static OperationRegistry bogotaOperations(
      final GasCalculator gasCalculator, final BigInteger chainId) {
<span class="fc" id="L1070">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L1071">    registerBogotaOperations(operationRegistry, gasCalculator, chainId);</span>
<span class="fc" id="L1072">    return operationRegistry;</span>
  }

  /**
   * Register bogota operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   * @param chainID the chain id
   */
  public static void registerBogotaOperations(
      final OperationRegistry registry,
      final GasCalculator gasCalculator,
      final BigInteger chainID) {
<span class="fc" id="L1086">    registerOsakaOperations(registry, gasCalculator, chainID);</span>
<span class="fc" id="L1087">  }</span>

  /**
   * Future eips evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM futureEips(final EvmConfiguration evmConfiguration) {
<span class="fc" id="L1096">    return futureEips(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * Future eips evm.
   *
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM futureEips(final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L1107">    return futureEips(new PragueGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * Future eips evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM futureEips(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L1122">    return new EVM(</span>
<span class="fc" id="L1123">        futureEipsOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.FUTURE_EIPS);
  }

  /**
   * Future Operation registry for eIPs's operations.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @return the operation registry
   */
  public static OperationRegistry futureEipsOperations(
      final GasCalculator gasCalculator, final BigInteger chainId) {
<span class="fc" id="L1138">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L1139">    registerFutureEipsOperations(operationRegistry, gasCalculator, chainId);</span>
<span class="fc" id="L1140">    return operationRegistry;</span>
  }

  /**
   * Register FutureEIPs operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   * @param chainID the chain id
   */
  public static void registerFutureEipsOperations(
      final OperationRegistry registry,
      final GasCalculator gasCalculator,
      final BigInteger chainID) {
<span class="fc" id="L1154">    registerBogotaOperations(registry, gasCalculator, chainID);</span>

    // &quot;big&quot; EOF
<span class="fc" id="L1157">    registry.put(new RelativeJumpOperation(gasCalculator));</span>
<span class="fc" id="L1158">    registry.put(new RelativeJumpIfOperation(gasCalculator));</span>
<span class="fc" id="L1159">    registry.put(new RelativeJumpVectorOperation(gasCalculator));</span>
<span class="fc" id="L1160">    registry.put(new CallFOperation(gasCalculator));</span>
<span class="fc" id="L1161">    registry.put(new RetFOperation(gasCalculator));</span>
<span class="fc" id="L1162">  }</span>

  /**
   * Experimental eips evm.
   *
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM experimentalEips(final EvmConfiguration evmConfiguration) {
<span class="nc" id="L1171">    return experimentalEips(DEV_NET_CHAIN_ID, evmConfiguration);</span>
  }

  /**
   * Experimental eips evm.
   *
   * @param chainId the chain Id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM experimentalEips(
      final BigInteger chainId, final EvmConfiguration evmConfiguration) {
<span class="fc" id="L1183">    return experimentalEips(new PragueGasCalculator(), chainId, evmConfiguration);</span>
  }

  /**
   * Experimental eips evm.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @param evmConfiguration the evm configuration
   * @return the evm
   */
  public static EVM experimentalEips(
      final GasCalculator gasCalculator,
      final BigInteger chainId,
      final EvmConfiguration evmConfiguration) {
<span class="fc" id="L1198">    return new EVM(</span>
<span class="fc" id="L1199">        experimentalEipsOperations(gasCalculator, chainId),</span>
        gasCalculator,
        evmConfiguration,
        EvmSpecVersion.EXPERIMENTAL_EIPS);
  }

  /**
   * Operation registry for experimental's operations.
   *
   * @param gasCalculator the gas calculator
   * @param chainId the chain id
   * @return the operation registry
   */
  public static OperationRegistry experimentalEipsOperations(
      final GasCalculator gasCalculator, final BigInteger chainId) {
<span class="fc" id="L1214">    OperationRegistry operationRegistry = new OperationRegistry();</span>
<span class="fc" id="L1215">    registerExperimentalEipsOperations(operationRegistry, gasCalculator, chainId);</span>
<span class="fc" id="L1216">    return operationRegistry;</span>
  }

  /**
   * Register experimental eips operations.
   *
   * @param registry the registry
   * @param gasCalculator the gas calculator
   * @param chainID the chain id
   */
  public static void registerExperimentalEipsOperations(
      final OperationRegistry registry,
      final GasCalculator gasCalculator,
      final BigInteger chainID) {
<span class="fc" id="L1230">    registerFutureEipsOperations(registry, gasCalculator, chainID);</span>
<span class="fc" id="L1231">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>