<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EthJsonRpcMethods.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">besu</a> &gt; <a href="index.source.html" class="el_package">org.hyperledger.besu.ethereum.api.jsonrpc.methods</a> &gt; <span class="el_source">EthJsonRpcMethods.java</span></div><h1>EthJsonRpcMethods.java</h1><pre class="source lang-java linenums">/*
 * Copyright Hyperledger Besu contributors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with
 * the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on
 * an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */
package org.hyperledger.besu.ethereum.api.jsonrpc.methods;

import org.hyperledger.besu.ethereum.api.ApiConfiguration;
import org.hyperledger.besu.ethereum.api.jsonrpc.RpcApis;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.filter.FilterManager;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthAccounts;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthBlobBaseFee;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthBlockNumber;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthCall;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthChainId;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthCoinbase;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthCreateAccessList;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthEstimateGas;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthFeeHistory;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGasPrice;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetBalance;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetBlockByHash;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetBlockByNumber;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetBlockReceipts;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetBlockTransactionCountByHash;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetBlockTransactionCountByNumber;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetCode;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetFilterChanges;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetFilterLogs;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetLogs;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetMinerDataByBlockHash;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetMinerDataByBlockNumber;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetProof;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetStorageAt;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetTransactionByBlockHashAndIndex;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetTransactionByBlockNumberAndIndex;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetTransactionByHash;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetTransactionCount;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetTransactionReceipt;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetUncleByBlockHashAndIndex;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetUncleByBlockNumberAndIndex;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetUncleCountByBlockHash;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetUncleCountByBlockNumber;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthGetWork;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthHashrate;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthMining;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthNewBlockFilter;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthNewFilter;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthNewPendingTransactionFilter;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthProtocolVersion;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthSendRawTransaction;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthSendTransaction;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthSubmitHashRate;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthSubmitWork;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthSyncing;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.EthUninstallFilter;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.JsonRpcMethod;
import org.hyperledger.besu.ethereum.api.jsonrpc.internal.results.BlockResultFactory;
import org.hyperledger.besu.ethereum.api.query.BlockchainQueries;
import org.hyperledger.besu.ethereum.blockcreation.MiningCoordinator;
import org.hyperledger.besu.ethereum.core.Synchronizer;
import org.hyperledger.besu.ethereum.eth.transactions.TransactionPool;
import org.hyperledger.besu.ethereum.mainnet.ProtocolSchedule;
import org.hyperledger.besu.ethereum.p2p.rlpx.wire.Capability;
import org.hyperledger.besu.ethereum.transaction.TransactionSimulator;

import java.util.Map;
import java.util.Set;

public class EthJsonRpcMethods extends ApiGroupJsonRpcMethods {

<span class="fc" id="L81">  private final BlockResultFactory blockResult = new BlockResultFactory();</span>

  private final BlockchainQueries blockchainQueries;
  private final Synchronizer synchronizer;
  private final ProtocolSchedule protocolSchedule;
  private final FilterManager filterManager;
  private final TransactionPool transactionPool;
  private final MiningCoordinator miningCoordinator;
  private final Set&lt;Capability&gt; supportedCapabilities;
  private final ApiConfiguration apiConfiguration;

  public EthJsonRpcMethods(
      final BlockchainQueries blockchainQueries,
      final Synchronizer synchronizer,
      final ProtocolSchedule protocolSchedule,
      final FilterManager filterManager,
      final TransactionPool transactionPool,
      final MiningCoordinator miningCoordinator,
      final Set&lt;Capability&gt; supportedCapabilities,
<span class="fc" id="L100">      final ApiConfiguration apiConfiguration) {</span>
<span class="fc" id="L101">    this.blockchainQueries = blockchainQueries;</span>
<span class="fc" id="L102">    this.synchronizer = synchronizer;</span>
<span class="fc" id="L103">    this.protocolSchedule = protocolSchedule;</span>
<span class="fc" id="L104">    this.filterManager = filterManager;</span>
<span class="fc" id="L105">    this.transactionPool = transactionPool;</span>
<span class="fc" id="L106">    this.miningCoordinator = miningCoordinator;</span>
<span class="fc" id="L107">    this.supportedCapabilities = supportedCapabilities;</span>
<span class="fc" id="L108">    this.apiConfiguration = apiConfiguration;</span>
<span class="fc" id="L109">  }</span>

  @Override
  protected String getApiGroup() {
<span class="fc" id="L113">    return RpcApis.ETH.name();</span>
  }

  @Override
  protected Map&lt;String, JsonRpcMethod&gt; create() {
<span class="fc" id="L118">    return mapOf(</span>
        new EthAccounts(),
        new EthBlockNumber(blockchainQueries),
        new EthGetBalance(blockchainQueries),
        new EthGetBlockByHash(blockchainQueries, blockResult),
        new EthGetBlockByNumber(blockchainQueries, blockResult, synchronizer),
        new EthGetBlockReceipts(blockchainQueries, protocolSchedule),
        new EthGetBlockTransactionCountByNumber(blockchainQueries),
        new EthGetBlockTransactionCountByHash(blockchainQueries),
        new EthCall(
            blockchainQueries,
            new TransactionSimulator(
<span class="fc" id="L130">                blockchainQueries.getBlockchain(),</span>
<span class="fc" id="L131">                blockchainQueries.getWorldStateArchive(),</span>
                protocolSchedule,
<span class="fc" id="L133">                apiConfiguration.getGasCap())),</span>
        new EthFeeHistory(
            protocolSchedule,
<span class="fc" id="L136">            blockchainQueries.getBlockchain(),</span>
            miningCoordinator,
            apiConfiguration),
        new EthGetCode(blockchainQueries),
<span class="fc" id="L140">        new EthGetLogs(blockchainQueries, apiConfiguration.getMaxLogsRange()),</span>
        new EthGetProof(blockchainQueries),
        new EthGetUncleCountByBlockHash(blockchainQueries),
        new EthGetUncleCountByBlockNumber(blockchainQueries),
        new EthGetUncleByBlockNumberAndIndex(blockchainQueries),
        new EthGetUncleByBlockHashAndIndex(blockchainQueries),
        new EthNewBlockFilter(filterManager),
        new EthNewPendingTransactionFilter(filterManager),
        new EthNewFilter(filterManager),
        new EthGetTransactionByHash(blockchainQueries, transactionPool),
        new EthGetTransactionByBlockHashAndIndex(blockchainQueries),
        new EthGetTransactionByBlockNumberAndIndex(blockchainQueries),
        new EthGetTransactionCount(blockchainQueries, transactionPool),
        new EthGetTransactionReceipt(blockchainQueries, protocolSchedule),
        new EthUninstallFilter(filterManager),
        new EthGetFilterChanges(filterManager),
        new EthGetFilterLogs(filterManager),
        new EthSyncing(synchronizer),
        new EthGetStorageAt(blockchainQueries),
        new EthSendRawTransaction(transactionPool),
        new EthSendTransaction(),
        new EthEstimateGas(
            blockchainQueries,
            new TransactionSimulator(
<span class="fc" id="L164">                blockchainQueries.getBlockchain(),</span>
<span class="fc" id="L165">                blockchainQueries.getWorldStateArchive(),</span>
                protocolSchedule,
<span class="fc" id="L167">                apiConfiguration.getGasCap())),</span>
        new EthCreateAccessList(
            blockchainQueries,
            new TransactionSimulator(
<span class="fc" id="L171">                blockchainQueries.getBlockchain(),</span>
<span class="fc" id="L172">                blockchainQueries.getWorldStateArchive(),</span>
                protocolSchedule,
<span class="fc" id="L174">                apiConfiguration.getGasCap())),</span>
        new EthMining(miningCoordinator),
        new EthCoinbase(miningCoordinator),
        new EthProtocolVersion(supportedCapabilities),
        new EthGasPrice(blockchainQueries, miningCoordinator, apiConfiguration),
        new EthGetWork(miningCoordinator),
        new EthSubmitWork(miningCoordinator),
        new EthHashrate(miningCoordinator),
        new EthSubmitHashRate(miningCoordinator),
<span class="fc" id="L183">        new EthChainId(protocolSchedule.getChainId()),</span>
        new EthGetMinerDataByBlockHash(blockchainQueries, protocolSchedule),
        new EthGetMinerDataByBlockNumber(blockchainQueries, protocolSchedule),
<span class="fc" id="L186">        new EthBlobBaseFee(blockchainQueries.getBlockchain(), protocolSchedule));</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>